{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\nimport axios from \"axios\";\nconst KEY = \"53364959-970251902b7523d6caf21016a\";\n\nconst URL = \"https://pixabay.com/api/\";\n\nexport const PER_PAGE = 15;\n\nexport async function getImagesByQuery(query, page) {\n    const response = await\n        axios.get(URL, {\n            params: {\n                key: KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: PER_PAGE,\n                page,\n            }\n        })\n    return response.data;\n};\n\n// const defaultParamas = {\n//     image_type: 'photo',\n//     orientation: 'horizontal',\n//     safesearch: true,\n// }\n\n// export function getImagesByQuery(query) {\n//     return axios.get(\"https://pixabay.com/api/\", {\n//         params: {\n//             key: KEY,\n//             q: query,\n//             image_type: 'photo',\n//             orientation: 'horizontal',\n//             safesearch: true,\n//         }\n//     }).then(response => response.data);\n// };\n// .then(response => new Promise(res => setTimeout(() => res(response.data), 800)));\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryList = document.querySelector(\".gallery\")\n\nconst loaderContainer = document.querySelector(\".loader-container\")\n\nexport const loadMoreBtn = document.querySelector(\".load-more-btn\");\n\n\nconst lightBox = new SimpleLightbox(\".gallery a\", {\n  captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    nav: true,\n    navText: ['←', '→'],\n    animationSpeed: 500,\n    loop: false\n});\n\nexport function createGallery(images) {\n\n  let markup = \"\";\n\n  for (const image of images) {\n\n    const {\n      webformatURL, largeImageURL, tags, likes, views, comments, downloads\n    } = image;\n\n      markup += `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\" ${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n            loading=\"lazy\"\n          />\n        </a>\n      <ul class=\"gallery-info\">\n        <li class=\"gallery-info-item\">\n          <span>Likes</span>\n          ${likes}\n        </li>\n        <li class=\"gallery-info-item\">\n          <span>Views</span>\n          ${views}\n        </li>\n        <li class=\"gallery-info-item\">\n          <span>Comments</span>\n          ${comments}\n        </li>\n        <li class=\"gallery-info-item\">\n          <span>Downloads</span>\n          ${downloads}\n        </li>\n      </ul>\n    </li>`;\n  };\n\n  galleryList.insertAdjacentHTML(\"beforeEnd\", markup);\n  lightBox.refresh();\n};\n\nexport function clearGallery() {\n  galleryList.innerHTML = \"\";\n};\n\nexport function showLoader() {\n  loaderContainer.classList.remove('is-hidden');\n};\n\nexport function hideLoader() {\n  loaderContainer.classList.add('is-hidden');\n};\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove('is-hidden');\n};\n\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add('is-hidden');\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery, PER_PAGE} from \"./js/pixabay-api\";\nimport { createGallery, clearGallery, showLoader, hideLoader, loadMoreBtn, showLoadMoreButton, hideLoadMoreButton,} from \"./js/render-functions\";\n\nconst form = document.querySelector(\".form\");\nconst input = document.querySelector('[name = \"search-text\"]');\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\n// const input = form.elements[\"search-text\"];\n\nform.addEventListener('submit', onSearchFormSubmit);\nif (loadMoreBtn) {\n    loadMoreBtn.addEventListener('click', onLoadMoreClick);\n}\n\nasync function onSearchFormSubmit(e) {\n    e.preventDefault();\n    const query = input.value.trim();\n    if (!query) {\n        iziToast.warning({\n            title: 'Warning!',\n            message: 'Please enter a search request!',\n            position: 'topRight',\n        });\n        return;\n    }\n    currentQuery = query;\n    currentPage = 1;\n    totalHits = 0;\n    clearGallery();\n    showLoadMoreButton();\n    showLoader();\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        hideLoader();\n        if (!data.hits || data.hits.length === 0) {\n            iziToast.info({\n                title: 'Attention!',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n            });\n            return;\n        }\n        totalHits = data.totalHits;\n        createGallery(data.hits);\n        const isMorePages = currentPage * PER_PAGE < totalHits;\n        if (isMorePages) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n            iziToast.info({\n                title: 'Attention!',\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n            });\n        };\n    } catch(error) {\n        hideLoader();\n        \n        \n        iziToast.error({\n            message: 'Something went wrong! Please try again later!',\n            position: 'topRight',\n            color: '#EF4040',\n            messageColor: '#FAFAFB',\n            iconText: '',\n            iconUrl: './img/error-icon.svg',\n            iconColor: '#FAFAFB',\n        });\n    }\n    form.reset();\n};\n\nasync function onLoadMoreClick() { \n    currentPage += 1;\n    hideLoadMoreButton();\n    showLoader();\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        hideLoader();\n        createGallery(data.hits);\n        smoothScroll();\n        const isMorePages = currentPage * PER_PAGE < totalHits;\n        if (isMorePages) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n            iziToast.info({\n                title: 'Attention!',\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n            });\n        };\n    } catch (error) {\n        hideLoader();\n        console.log('errorSubmit', error);\n        console.log('response', error?.response);\n        iziToast.error({\n            message: 'Something went wrong! Please try again later!',\n            position: 'topRight',\n            color: '#EF4040',\n            messageColor: '#FAFAFB',\n            iconText: '',\n            iconUrl: './img/error-icon.svg',\n            iconColor: '#FAFAFB',\n        });\n    };\n    \n};\n\nfunction smoothScroll() { \n    const firstCard = document.querySelector('.gallery-item');\n    if (!firstCard)\n        return;\n    const cardHeight = firstCard.getBoundingClientRect().height;\n    window.scrollBy({\n        top: cardHeight * 5,\n        behavior: 'smooth',\n    })\n};\n\n// getBoundingClientRect() Метод JS, определяет положение элемента относительно видимой области экрана. Взависимости от того какой размер экрана у пользователя.Возвращает объект с всеми размерами экрана\n\n"],"names":["KEY","URL","PER_PAGE","getImagesByQuery","query","page","axios","galleryList","loaderContainer","loadMoreBtn","lightBox","SimpleLightbox","createGallery","images","markup","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","input","currentQuery","currentPage","totalHits","onSearchFormSubmit","onLoadMoreClick","e","iziToast","data","smoothScroll","error","firstCard","cardHeight"],"mappings":"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"}